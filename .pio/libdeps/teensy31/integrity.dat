https://github.com/gfvalvo/NewEncoder